<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>React Tutorial</title>
    <!-- Not present in the tutorial. Just for basic styling. -->
    <link rel="stylesheet" href="css/base.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js"></script>
    <style type="text/css">
    .selected{
      text-decoration: underline;
    }
    </style>
  </head>
  <body>
    <div id="content"></div>
    <script type="text/babel" src="scripts/example.js"></script>
    <script type="text/babel">

    var MenuComponent = React.createClass({
        getInitialState: function(){
            return { focus: 0 };
        },
        changeFocus: function(index){
            this.setState({focus: index});
        },
        render: function() {
            var self = this;
            return (
                <div>
                    <ul>{ this.props.items.map(function(title, index){
            
                        var style = '';
            
                        if(self.state.focus == index){
                            style = 'selected';
                        }
            
                        return <li className={style} onClick={self.changeFocus.bind(self, index)}>{title}</li>;
            
                    }) }
                            
                    </ul>
                    <h1>Menu item selected: {this.props.items[this.state.focus]}</h1>
                </div>
            );
        }
    });

var SearchComponent = React.createClass({
  getInitialState:function(){
    return {
      books:this.props.items
    };
  },
  searchingEvent: function(e){
     var searching = e.target.value;
     var books=this.state.books.slice();
     searching=searching.toString().toLowerCase()
     if(searching.length > 0){
        books=books.filter(function(it){
          return it.name.toString().toLowerCase().indexOf(searching) > -1;
        });
        this.setState({books:books});
     }else{
        this.setState({books:this.props.items});
     }
  },
  render:function(){
   
    var books= this.state.books.map(function(element){
    
      return (<div>{element.name}</div>);
    });

    return (
      <div>
      <input type="text" id="searchinput" onChange={this.searchingEvent} placeholder="search..."/>
       <div>{books}</div>
      </div>
     
    );
  }

});


var books = [
    { name: 'Titanium'},
    { name: 'React'},
    { name: 'React Native'},
    { name: 'Spring'},
    { name: 'TDD'},
    { name: 'Spock'},
    { name: 'Maven'},
    { name: 'Grails'},
    { name: 'PHP'},
    { name: '100 a√±os de Soledad'},
    { name: 'Las batallas :3'},
];

	   ReactDOM.render(
          <div>
          <MenuComponent items={ ['Home','About','Contact'] }/>
          <SearchComponent items={books}/>
          </div>,
          document.getElementById("content")
      );
    </script>
  </body>
</html>
